<!DOCTYPE html>
<html>
    <title>all blogs test page...</title>
    <head>
        <link rel="stylesheet" type="text/css" href="styles/styles.css">
        <link rel="preconnect" href="https://fonts.gstatic.com"> 
        <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Spicy+Rice&family=Caveat&family=Fira+Code:wght@300&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@200&display=swap" rel="stylesheet">
      </head>

      <body>
          <h1>Raw Blog Posts, y'all!</h1>
            
             <p id="blogsDiv"></p>

          <script>
                const urlToFetch = `https://kuefte6pgk.execute-api.us-east-2.amazonaws.com/dev`;
                    
                fetch(urlToFetch)
                    .then(function (response) {
                        const jsonResponse = response.json();
                        return jsonResponse; // Our Promise object
                    })
                    .then(function (data) {
                    // 'data' is an Object at this point...this is basically the record set returned bt dynamoDB
                    // First let's return an array of the object's properties
                        const returnedData = Object.entries(data); 
                      
                    // Next let's just get the 'body' property returned by the Lambda call
                       for (const [key, value] of returnedData) {
                           if (key === "body"){
                            /** 
                             * Now that we have the 'body' key, we need to convert the value 
                             * (currently a JSON String) to a JSON Object 
                             * so that we can pull out the properties of each blog post 
                             **/ 
                            const blogPostArray = JSON.parse(value);
                          
                            /** Now that the data we got back is a JSON object, let's loop over all the Posts...
                             * The 'Items' property holds an array of all the blog posts 
                             * Let's loop through that array and display the fields we want!
                             * We created a function to control the display of the blog post
                             * data on the page - let's call it once for each blog post
                             **/
                            for (var i = 0; i < blogPostArray.Items.length; i++) {
                                // console.log(`Blog Post #${i}:`);
                                // console.log(blogPostArray.Items[i].postBody);
                                addBlog(blogPostArray.Items[i].postBody);
                             }
                        }
                    } 
                        
                    })
                    .catch(function (err) {
                        console.log('Something went wrong...: ' + err);
                    });

                function addBlog(data) {
                    // Put the raw data into the blogsDiv...
                    var blogBody = document.getElementById("blogsDiv")
                    blogBody.innerHTML += data + "<br /> <br />"; 
                   
                }
          </script>
      </body>
</html>
